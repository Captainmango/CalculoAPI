CREATE TABLE IF NOT EXISTS  categories
(
id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  name VARCHAR(255),
CONSTRAINT categories_pkey PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS  roles
(
id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  name VARCHAR(20),
CONSTRAINT roles_pkey PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS users
(
  id              BIGINT NOT NULL,
created_at TIMESTAMP WITHOUT TIME ZONE,
  email           VARCHAR(255) NOT NULL,
  first_name      VARCHAR(255) NOT NULL,
  last_name       VARCHAR(255) NOT NULL,
  password_digest VARCHAR(255) NOT NULL,
updated_at TIMESTAMP WITHOUT TIME ZONE,
CONSTRAINT users_pkey PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS refreshtoken
(
  id      BIGINT NOT NULL,
expiry_date TIMESTAMP WITHOUT TIME ZONE NOT NULL,
  token   VARCHAR(255) NOT NULL,
  user_id BIGINT,
CONSTRAINT refreshtoken_pkey PRIMARY KEY(id)
);

ALTER TABLE users ADD CONSTRAINT uk_6dotkott2kjsp8vw4d0m25fb7 UNIQUE(email);

ALTER TABLE refreshtoken ADD CONSTRAINT uk_or156wbneyk8noo4jstv55ii3 UNIQUE(token);

CREATE SEQUENCE
IF NOT EXISTS hibernate_sequence AS bigint START WITH 1 INCREMENT BY 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;

CREATE TABLE IF NOT EXISTS transaction_categories
(
  transaction_id BIGINT NOT NULL,
  category_id    BIGINT NOT NULL,
CONSTRAINT transaction_categories_pkey PRIMARY KEY(transaction_id, category_id)
);

CREATE TABLE IF NOT EXISTS transactions
(
  id      BIGINT NOT NULL,
created_at TIMESTAMP WITHOUT TIME ZONE,
  notes   TEXT,
  title   VARCHAR(255) NOT NULL,
  total   FLOAT4 NOT NULL,
updated_at TIMESTAMP WITHOUT TIME ZONE,
  user_id BIGINT,
CONSTRAINT transactions_pkey PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS user_roles
(
  user_id BIGINT NOT NULL,
  role_id BIGINT NOT NULL,
CONSTRAINT user_roles_pkey PRIMARY KEY(user_id, role_id)
);

ALTER TABLE transaction_categories ADD CONSTRAINT fk4w5cqbyyhe713v88k32809a5i FOREIGN KEY(transaction_id)REFERENCES
transactions(id)ON
UPDATE NO ACTION ON
DELETE NO ACTION
;

ALTER TABLE refreshtoken ADD CONSTRAINT fka652xrdji49m4isx38pp4p80p FOREIGN KEY(user_id)REFERENCES users(id)ON
UPDATE NO ACTION ON
DELETE NO ACTION
;

ALTER TABLE user_roles ADD CONSTRAINT fkh8ciramu9cc9q3qcqiv4ue8a6 FOREIGN KEY(role_id)REFERENCES roles(id)ON
UPDATE NO ACTION ON
DELETE NO ACTION
;

ALTER TABLE user_roles ADD CONSTRAINT fkhfh9dx7w3ubf1co1vdev94g3f FOREIGN KEY(user_id)REFERENCES users(id)ON
UPDATE NO ACTION ON
DELETE NO ACTION
;

ALTER TABLE transaction_categories ADD CONSTRAINT fkl8nhemttklbafivosqgyv35rl FOREIGN KEY(category_id)REFERENCES
categories(id)ON
UPDATE NO ACTION ON
DELETE NO ACTION
;

ALTER TABLE transactions ADD CONSTRAINT fkqwv7rmvc8va8rep7piikrojds FOREIGN KEY(user_id)REFERENCES users(id)ON
UPDATE NO ACTION ON
DELETE NO ACTION
;

INSERT INTO categories (id, name) VALUES(1, 'CATEGORY_GROCERIES');
INSERT INTO categories (id, name) VALUES(2, 'CATEGORY_GENERAL');
INSERT INTO categories (id, name) VALUES(3, 'CATEGORY_CHARITY');
INSERT INTO categories (id, name) VALUES(4, 'CATEGORY_ENTERTAINMENT');
INSERT INTO categories (id, name) VALUES(5, 'CATEGORY_FINANCES');
INSERT INTO categories (id, name) VALUES(6, 'CATEGORY_EATING_OUT');
INSERT INTO categories (id, name) VALUES(7, 'CATEGORY_PERSONAL_CARE');
INSERT INTO categories (id, name) VALUES(8, 'CATEGORY_GIFTS');
INSERT INTO categories (id, name) VALUES(9, 'CATEGORY_HOLIDAYS');
INSERT INTO categories (id, name) VALUES(10, 'CATEGORY_BILLS');
INSERT INTO categories (id, name) VALUES(11, 'CATEGORY_FAMILY');
INSERT INTO categories (id, name) VALUES(12, 'CATEGORY_SHOPPING');
INSERT INTO categories (id, name) VALUES(13, 'CATEGORY_TRAVEL');

INSERT INTO roles (id, name) VALUES(1, 'ROLE_ADMIN');
INSERT INTO roles (id, name) VALUES(2, 'ROLE_USER');
